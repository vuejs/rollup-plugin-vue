machine:
  php:
    version: 7.0.4
  node:
    version: 5.6.0

dependencies:
  pre:
    - curl -o- -s -L https://yarnpkg.com/install.sh | bash
  override:
    - mkdir -p build/logs
    - composer global require sereno/installer
    - yarn --no-progress
    - export PATH=$PATH:"${HOME}/.config/composer/vendor/bin"
  cache_directories:
    - "~/.yarn-cache"
    - "~/.config/composer"

test:
  override:
    - yarn test

deployment:
  publish:
    branch:
      - master
      - documentation
    commands:
      - composer global require --no-progress sereno/installer
      - sereno deploy
